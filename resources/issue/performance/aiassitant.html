<html>
<head>
  <title>Evernote Export</title>
  <basefont face="微软雅黑" size="2" />
  <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
  <meta name="exporter-version" content="YXBJ Windows/600388 (zh-CN, DDL); Windows/10.0.0 (Win64);"/>
  <style>
    body, td {
      font-family: 微软雅黑;
      font-size: 10pt;
    }
  </style>
</head>
<body>
<a name="5405"/>

<div>
<span><div><div><br/></div><div><br/></div><div><span style="font-size: 16pt;">环境</span></div><div><font style="font-size: 16pt;"><br/></font></div><ul><li><div><span style="font-size: 12pt;">系统版本</span></div></li><ul><li><div><span style="font-size: 12pt;">V1.0.0.5</span></div></li></ul><li><div><span style="font-size: 12pt;">MCU版本</span></div></li><ul><li><div><span style="font-size: 12pt;">V4.4.2.8</span></div></li></ul><li><div><span style="font-size: 12pt;">固件版本</span></div></li><ul><li><div><span style="font-size: 12pt;">20181023214218.62</span></div></li></ul><li><div><span style="font-size: 12pt;">应用版本</span></div></li><ul><li><div><span style="font-size: 12pt;">V1.1   20181106      </span></div></li></ul><li><div><span style="font-size: 12pt;">时间</span></div></li><ul><li><div><span style="font-size: 12pt;">20181117</span></div></li></ul><li><div><span style="font-size: 12pt;">测试包见附件</span></div></li></ul><div><font style="font-size: 14pt;"><br/></font></div><div><font style="font-size: 14pt;"><br/></font></div><div><font style="font-size: 14pt;"><br/></font></div><div><span style="font-size: 18.6667px;">内存占用 </span> <span style="font-size: 12pt;">1.1 VS 1.0 </span></div><div><br/></div><hr/><div><br/></div><div><br/></div><div><span style="font-size: 14pt;">     状态：</span><span style="font-size: 14pt;"> </span><span style="font-size: 14pt;"> 初始态</span><span style="font-size: 14pt;"> </span> (<span style="font-size: 10pt;">如右图) </span></div><div><span style="font-size: 14pt;">     内存: </span><span style="font-size: 14pt;">   37.0 mb (PSS)</span></div><div><span style="font-size: 14pt;">     版本: </span><span style="font-size: 14pt;">   </span><span style="font-size: 14pt;">v1.0  (20181001)</span></div><div><span style="font-size: 14pt;"> </span></div><div><span style="font-size: 10pt;">                   </span> <span style="font-size: 10pt; font-weight: bold;">初始态是指，kill 程序后，重新启动</span><span style="font-size: 10pt;">。</span></div><div><br/></div><div style="margin-left: 40px;"><img src="aiassitant_files/Image.png" type="image/png" data-filename="Image.png"/><span style="font-size: 14pt;">   </span><img src="aiassitant_files/init_1.0.png" type="image/png" data-filename="init_1.0.png" width="235"/></div><div style="margin-left: 40px;"><br/></div><div style="margin-left: 40px;"><br/></div><div style="margin-left: 40px;"><br/></div><div style="margin-left: 40px;"><br/></div><div><br/></div><div><span style="font-size: 14pt;">     状态：</span><span style="font-size: 14pt;"> 初始态</span><span style="font-size: 14pt;"> </span> (<span style="font-size: 10pt;">如右图)</span></div><div><span style="font-size: 14pt;">     内存:   </span><span style="font-size: 12pt;">34.8 PSS </span></div><div><span style="font-size: 14pt;">     版本: </span><span style="font-size: 14pt;">  1.1  (20181106见附件)</span></div><div><span style="font-size: 14pt;">     下降：</span> <span style="font-size: 10pt; color: rgb(255, 0, 0);">5%</span></div><div><span style="font-size: 14pt;">    </span></div><div><br/></div><div><span style="font-size: 18.6667px;">        </span><span style="font-size: 14pt;"><img src="aiassitant_files/Image [1].png" type="image/png" data-filename="Image.png"/>  </span><img src="aiassitant_files/init.png" type="image/png" data-filename="init.png" width="230"/></div><div><br/></div><div style="margin-left: 40px;"><br/></div><div><font style="font-size: 14pt;"><br/></font></div><div><br/></div><div><br/></div><div><br/></div><hr/><div style="margin-left: 40px;"></div><div><br/></div><div><span style="font-size: 14pt;">     状态：</span><span style="font-size: 14pt;"> 主页张开</span><span style="font-size: 14pt;"> </span> (<span style="font-size: 10pt;">如右图)</span></div><div><span style="font-size: 14pt;">     内存:  </span><span style="font-size: 14pt;">74MB pss</span></div><div><span style="font-size: 14pt;">     版本: </span><span style="font-size: 14pt;"> 1.0  </span></div><div><span style="font-size: 14pt;">    </span><img src="aiassitant_files/Image [2].png" type="image/png" data-filename="Image.png"/><span style="font-size: 14pt;"> </span><img src="aiassitant_files/show_1.0.png" type="image/png" data-filename="show_1.0.png" width="199"/></div><div><br/></div><div><span style="font-size: 14pt;">     状态：</span><span style="font-size: 14pt;"> 主页张开</span><span style="font-size: 14pt;"> </span> (<span style="font-size: 10pt;">如右图)</span></div><div><span style="font-size: 14pt;">     内存:   </span><span style="font-size: 12pt;">45.2MB pss</span></div><div><span style="font-size: 14pt;">     版本: </span><span style="font-size: 14pt;">  1.1  </span></div><div><span style="font-size: 14pt;">     下降：</span> <span style="font-size: 10pt; color: rgb(255, 0, 0);">44%</span></div><div><span style="font-size: 14pt;">        </span><span style="font-size: 14pt;"><img src="aiassitant_files/Image [3].png" type="image/png" data-filename="Image.png"/>   </span><img src="aiassitant_files/show.png" type="image/png" data-filename="show.png" width="216"/></div><div><span style="font-size: 14pt;">        </span></div><div><span style="font-size: 14pt;">    </span></div><div>    </div><div><span style="font-size: 14pt;"> </span></div><div><br/></div><div><br/></div><div><br/></div><hr/><div><span style="font-size: 14pt;">    </span></div><div><span style="font-size: 14pt;">     状态： 收回      (从新回到主页)</span></div><div><span style="font-size: 14pt;">     内存:   62 MB （pss）</span></div><div><span style="font-size: 14pt;">     版本:   1.0  </span></div><div><br/></div><div><img src="aiassitant_files/Image [4].png" type="image/png" data-filename="Image.png"/><span style="font-size: 14pt;">      </span><img src="aiassitant_files/end.png" type="image/png" data-filename="end.png" width="202"/></div><div><font style="font-size: 14pt;"><br/></font></div><div><font style="font-size: 14pt;"><br/></font></div><div><span style="font-size: 14pt;">     状态： 收回 </span> <span style="font-size: 10pt;">如右图</span></div><div><span style="font-size: 14pt;">     内存占用: 40.3MB pss</span></div><div><span style="font-size: 14pt;">     版本: 1.1</span></div><div><span style="font-size: 14pt;">     下降: </span> <span style="font-size: 10pt; color: rgb(255, 0, 0);">36%</span></div><div><br/></div><div><span style="font-size: 14pt;">    </span></div><div><span style="font-size: 14pt;">      </span><span style="font-size: 14pt;"><img src="aiassitant_files/Image [5].png" type="image/png" data-filename="Image.png"/>    </span><img src="aiassitant_files/end [1].png" type="image/png" data-filename="end.png" width="186"/></div><div><br/></div><div><br/></div><div><br/></div><div><span style="font-size: 14pt;">   </span></div><div>    </div><div><span style="font-size: 14pt;">小结：</span></div><div><span style="font-size: 14pt;">        在初始状态，展开状态，回到主页状态下内存占用分别下降： </span><span style="font-size: 14pt;">5% , 36% ,44%。</span></div><div><span style="font-size: 14pt;">                </span></div><div><span style="font-size: 14pt;">原因：</span></div><div><span style="font-size: 14pt;">        优化主要集中到Dalvik Heap区。</span></div><ul><ul><li><div><span style="font-size: 14pt;">        在1.0 有一张 1080*1920 的背景图 占用Dalvik区域8MB的内存，在1.1被换了方案，被去掉了。</span></div></li><li><div><br/></div></li></ul></ul><div><span style="font-size: 14pt;">            </span><span style="font-size: 14pt;"><img src="aiassitant_files/Image [6].png" type="image/png" data-filename="Image.png" width="715"/></span></div><div><br/></div><div><br/></div><div><span style="font-size: 14pt;">其他建议： </span></div><div><br/></div><div><span style="font-size: 14pt;">     Webp如果在效果不影响的前提下可以考虑使用 ARBG_4444来编码，这样可以节约 如果是 380*380的图 4~5 帧  可节约约 2MB/webAnimation。</span></div><div><span style="font-size: 14pt;">        </span></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><span style="font-size: 14pt;">CPU 占用</span></div><div><br/></div><hr/><div><span style="font-size: 14pt;"> </span></div><div><span style="font-size: 14pt;">主线程：   </span></div><div><span style="font-size: 14pt;">   eng.aiassistant com.xiaopeng.aiassistant</span></div><div><span style="font-size: 18.6667px;">WebP线程：</span></div><div><span style="font-size: 14pt;">   FrameSequence d com.xiaopeng.aiassistant</span></div><div><br/></div><div><br/></div><div><span style="font-size: 14pt;">WebP线程： </span></div><div><span style="font-size: 14pt;">            小图时候：     占用 2%上下。</span></div><div><span style="font-size: 14pt;">            大图的时候： </span><span style="font-size: 14pt;">占用 5% 上下。</span><span style="font-size: 14pt;"> </span></div><div><br/></div><div><span style="font-size: 14pt;">            负责工作： 从Native区取出一帧数据，并没有做其他的工作，占用cpu比例少，目前找不到优化空间.</span></div><div><br/></div><div><span style="font-size: 14pt;">             </span></div><div><span style="font-size: 14pt;">       </span><span style="font-size: 14pt;"><img src="aiassitant_files/Image [7].png" type="image/png" data-filename="Image.png"/></span></div><div><br/></div><div><br/></div><div><br/></div><div><span style="font-size: 14pt;">主线程</span></div><div><span style="font-size: 14pt;">        </span></div><div><span style="font-size: 14pt;">        CPU占比： 4 ~15% </span></div><div><br/></div><div><span style="font-size: 14pt;">        </span><span style="font-size: 14pt;"><img src="aiassitant_files/Image [8].png" type="image/png" data-filename="Image.png"/></span></div><div><br/></div><div><br/></div><div><span style="font-size: 14pt;">       </span><span style="font-size: 14pt;">负责工作: </span></div><div><span style="font-size: 14pt;">                因为 webP 组件引起视图变化，主线程处理显示列表也是个正常要处理的流程，目前观察不到主线程有做其他的无用功。</span></div><div><br/></div><div><br/></div><div><br/></div><div><span style="font-size: 14pt;"> 小结</span></div><ul><ul><li><div><span style="font-size: 14pt;">    CPU 占用方面目前没有发现可下手的地方。</span></div></li></ul></ul><div><br/></div><div><span style="font-size: 14pt;">            </span></div><div><span style="font-size: 14pt;">详细记录见附件： </span></div><div><br/></div><div><br/></div><div><span style="font-size: 14pt;"><a href="aiassitant_files/all_1_cpu.txt1"><img src="aiassitant_files/3d6e218c0f5ce45478dae357e8e70af9.png" alt="all_1_cpu.txt1"></a></span></div><div><br/></div><div><br/></div><div><br/></div></div><div><br/></div></span>
</div></body></html> 