<html>
<head>
  <title>Evernote Export</title>
  <basefont face="微软雅黑" size="2" />
  <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
  <meta name="exporter-version" content="YXBJ Windows/600553 (zh-CN, DDL); Windows/10.0.0 (Win64);"/>
  <style>
    body, td {
      font-family: 微软雅黑;
      font-size: 10pt;
    }
  </style>
</head>
<body>
<a name="7748"/>

<div>
<span><div><div><br/></div><div><br/></div><div><span style="font-size: 16pt;">编写目的</span></div><ul><ul><li><div><span style="font-size: 12pt;">解决个应用之间弹出窗口相互掩盖,相互之间无法通讯的问题.</span></div></li></ul></ul><div><br/></div><div><br/></div><div><span style="font-size: 16pt;">文档范围</span></div><ul><ul><li><div><span style="font-size: 12pt;">此文档之定义个应用之间弹出窗口达到互斥的规则.</span></div></li></ul></ul><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 16pt;">实现原理</span></div><div style="margin-left: 40px;"><span style="font-size: 16pt;">            </span></div><div style="margin-left: 40px;"><span style="font-size: 14pt;">IPC See More detail : </span></div><div style="margin-left: 40px;"><a href="http://doc.xiaopeng.local:18090/pages/viewpage.action?pageId=20153439">http://doc.xiaopeng.local:18090/pages/viewpage.action?pageId=20153439</a></div><div><span style="font-size: 16pt;">                    </span></div><div style="margin-left: 120px;"><img src="hc/WindowManager.bmp" type="image/bmp" data-filename="WindowManager.bmp" width="868"/></div><div style="margin-left: 120px;"><br/></div><div style="margin-left: 120px;"><br/></div><div style="margin-left: 40px;"><img src="hc/str.png" type="image/png" data-filename="str.png"/><br/></div><div style="margin-left: 40px;"><br/></div><div style="margin-left: 40px;"><br/></div><ul><li><div><font style="font-size: 14pt;"> IOnWindowIPCListener </font></div></li><ul><li><div><font style="font-size: 12pt;">客户端需要实现的接口</font></div></li><ul><li><div><span style="font-size: 14pt;">IOnWindowIPCListener.</span><span style="font-size: 14pt;">onWindowIPCEvent(boolean flag , String sender)</span></div></li><ul><li><div><font style="font-size: 12pt;">flag 标识 true表示打开 false表示关闭</font></div></li><li><div><font style="font-size: 12pt;">Sender 表示发送者包名</font></div></li></ul></ul></ul><li><div><span style="font-size: 12pt;">MainActivity</span></div></li><ul><li><div><span style="font-size: 12pt;">这里代表客户端程序</span></div></li></ul><li><div><font style="font-size: 14pt;">XwindowIPCImpl</font></div></li><ul><li><div><font style="font-size: 12pt;">封装了EventBus注册,以及IPC发送消息的过程,客户端无需感知</font></div></li></ul></ul><div><span style="font-size: 14.6667px;"><br/></span></div><div><span style="font-size: 14.6667px;"><br/></span></div><div><span style="font-size: 14.6667px;"><br/></span></div><div><span style="font-size: 14.6667px;"><br/></span></div><div><span style="font-size: 16pt;">目前互斥应用范围 [</span><span style="font-size: 10pt;">范围是指现在或者将来需要这项能力</span><span style="font-size: 16pt;">]</span></div><div><br/></div><div><div><br/></div><table style="border-collapse: collapse; min-width: 100%;"><colgroup><col style="width: 130px;"></col><col style="width: 130px;"></col><col style="width: 336px;"></col><col style="width: 207px;"></col><col style="width: 207px;"></col></colgroup><tbody><tr><td style="vertical-align: middle; width: 130px; padding: 8px; border: 1px solid;"><div>序号</div></td><td style="vertical-align: middle; width: 130px; padding: 8px; border: 1px solid;"><div><span style="font-size: 12pt;">应用名</span></div></td><td style="vertical-align: middle; width: 336px; padding: 8px; border: 1px solid;">包名</td><td style="vertical-align: middle; width: 207px; padding: 8px; border: 1px solid;"><div>时间</div></td><td style="vertical-align: middle; width: 207px; padding: 8px; border: 1px solid;"><div><br/></div></td></tr><tr><td style="vertical-align: middle; width: 130px; padding: 8px; border: 1px solid;"><div><span style="font-size: 12pt;">1</span></div></td><td style="vertical-align: middle; width: 130px; padding: 8px; border: 1px solid;"><div>空调</div></td><td style="vertical-align: middle; width: 336px; padding: 8px; border: 1px solid;"><div><span style="font-size: 16pt;">com.android.systemui</span></div></td><td style="vertical-align: middle; width: 207px; padding: 8px; border: 1px solid;"><div><span style="font-size: 12pt;">2019/1/31</span></div></td><td style="vertical-align: middle; width: 207px; padding: 8px; border: 1px solid;"><div><br/></div></td></tr><tr><td style="vertical-align: middle; width: 130px; padding: 8px; border: 1px solid;"><div><span style="font-size: 12pt;">2</span></div></td><td style="vertical-align: middle; width: 130px; padding: 8px; border: 1px solid;"><div><span style="font-size: 12pt;">AI助手</span></div></td><td style="vertical-align: middle; width: 336px; padding: 8px; border: 1px solid;"><div><span style="font-size: 16pt;">com.xiaopeng.aiassistant</span></div></td><td style="vertical-align: middle; width: 207px; padding: 8px; border: 1px solid;"><div><span style="font-size: 12pt;">2019/1/31</span></div></td><td style="vertical-align: middle; width: 207px; padding: 8px; border: 1px solid;"><div><br/></div></td></tr><tr><td style="vertical-align: middle; width: 130px; padding: 8px; border: 1px solid;"><div><span style="font-size: 12pt;">3</span></div></td><td style="vertical-align: middle; width: 130px; padding: 8px; border: 1px solid;"><div><span style="font-size: 12pt;">自动泊车</span></div></td><td style="vertical-align: middle; width: 336px; padding: 8px; border: 1px solid;"><div><span style="font-size: 16pt;">com.xiaopeng.autopilot</span></div></td><td style="vertical-align: middle; width: 207px; padding: 8px; border: 1px solid;"><div><span style="font-size: 12pt;">2019/1/31</span></div></td><td style="vertical-align: middle; width: 207px; padding: 8px; border: 1px solid;"><div><br/></div></td></tr><tr><td style="vertical-align: middle; width: 130px; padding: 8px; border: 1px solid;"><div><span style="font-size: 12pt;">4</span></div></td><td style="vertical-align: middle; width: 130px; padding: 8px; border: 1px solid;"><div><span style="font-size: 12pt;">充电</span></div></td><td style="vertical-align: middle; width: 336px; padding: 8px; border: 1px solid;"><div><span style="font-size: 16pt;">com.xiaopeng.chargecontrol</span></div></td><td style="vertical-align: middle; width: 207px; padding: 8px; border: 1px solid;"><div><span style="font-size: 12pt;">2019/1/31</span></div></td><td style="vertical-align: middle; width: 207px; padding: 8px; border: 1px solid;"><div><br/></div></td></tr><tr><td style="vertical-align: middle; width: 130px; padding: 8px; border: 1px solid;"><div><span style="font-size: 12pt;">5</span></div></td><td style="vertical-align: middle; width: 130px; padding: 8px; border: 1px solid;"><div><span style="font-size: 12pt;">车控</span></div></td><td style="vertical-align: middle; width: 336px; padding: 8px; border: 1px solid;"><div><span style="font-size: 16pt;">com.xiaopeng.carcontrol</span></div></td><td style="vertical-align: middle; width: 207px; padding: 8px; border: 1px solid;"><div><span style="font-size: 12pt;">2019/1/31</span></div></td><td style="vertical-align: middle; width: 207px; padding: 8px; border: 1px solid;"><div><br/></div></td></tr></tbody></table><div><br/></div></div><div><font style="font-size: 12pt;"><br/></font></div><div><br/></div><div><br/></div><div><br/></div><div><span style="font-size: 16pt;">接入步骤</span></div><ul><li><div><font style="font-size: 14pt;">依赖libxui</font></div></li><li><div><font style="font-size: 14pt;">完成XUI的初始化[<font>可在应用启动时完成</font>]</font></div></li></ul><div style="margin-left: 40px;"><br/></div><div style="margin-left: 40px;"><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>@Override</div><div>    protected void onCreate(Bundle savedInstanceState) {</div><div>        super.onCreate(savedInstanceState);</div><div>        XUI.init(getApplicationContext());</div><div>        setContentView(R.layout.activity_main);</div><div>        </div><div>}</div></div></div><ul><li><div><font style="font-size: 14pt;">实现IOnWindIPCLIstener.接口方法完成相应逻辑</font></div></li></ul><div style="margin-left: 40px;"><br/></div><div style="margin-left: 40px;"><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>/**</div><div>     * @param flag   窗口打开还是关闭</div><div>     * @param sender 消息发送者包名</div><div>     */</div><div>    public void onWindowIPCEvent(boolean flag, String sender) {</div><div>        //</div><div>        Log.i(&quot;tyler.tang&quot;, &quot;IPC one from &quot; + sender);</div><div>    }</div><div><br/></div><div><br/></div></div></div><ul><li><div><span style="font-size: 16pt;">注册需要实现的监听</span></div></li></ul><div style="margin-left: 40px;"><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><span>  XWindowIPCImpl ipc = new XWindowIPCImpl();</span></div><div><span>  ipc.register(IOnWindIPCLIstener);</span></div></div></div><ul><li><div><span style="font-size: 16pt;">窗口show出来时调用方法通知其他应用</span></div></li></ul><div style="margin-left: 40px;"><br/></div><div style="margin-left: 40px;"><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>   XWindowUtil.notifyAllWindow(true, &quot;com.sny.ipcone&quot;);</div></div></div><ul><li><div><font style="font-size: 14pt;">窗口关闭时时调用方法通知其他应用</font></div></li></ul><div style="margin-left: 40px;"><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>XWindowUtil.notifyAllWindow(false, &quot;com.sny.ipcone&quot;);</div></div><br/></div><div style="margin-left: 40px;"><br/></div><div style="margin-left: 40px;"><br/></div><div style="margin-left: 40px;"><font style="font-size: 14pt;">客户端程序Demo</font></div><div style="margin-left: 40px;"><font style="font-size: 14pt;"><br/></font></div><div style="margin-left: 40px;"><span style="font-size: 14pt;"><a href="hc/ipcone.rar"><img src="hc/58579116f563f8e519fa5faee62650ec.png" alt="ipcone.rar"></a></span><br/></div><div style="margin-left: 120px;"><br/></div><div><br/></div><div><span style="font-size: 14pt;"><br/></span></div><div><span style="font-size: 14pt;"><br/></span></div><div style="margin-left: 40px;"><br/></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div style="margin-left: 80px;"><br/></div></div><div><br/></div></span>
</div></body></html> 